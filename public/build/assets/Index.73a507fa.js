import{d as z,u as oe,C as I,v as le,r as h,y as N,n as p,b as d,o as r,e as v,g as o,h as a,F as x,q as se,f as _,t as l,j as c,k as b,i as y,x as ne,l as re,p as w,E,H as de}from"./app.2d2cf3e6.js";import{_ as ie,j as ue}from"./breadcrumbsData.2260b39f.js";import{c as R}from"./index.673391cf.js";import{f as j}from"./index.18f6e9ea.js";const ce={class:"q-mt-md"},pe={class:"full-width row flex-center text-primary q-gutter-sm"},me={class:"text-red"},ge={class:"row flex-center q-gutter-x-sm no-wrap"},_e={class:"text-primary text-subtitle1"},fe={class:"text-primary text-subtitle1"},be={key:0},we={key:1,class:"text-grey"},he={class:"q-table__title text-primary"},ve=z({__name:"PostTable",props:{paginatedData:null,sortingData:null},setup(B){const n=B,C=oe(),m=I({}),D=I({}),H=le(()=>(i.value=!1,n.paginatedData.data.forEach((t,u)=>{m[`${t.id}`]=h(`${t.status}`),D[`${t.id}`]=h(`${t.favorite}`)}),n.paginatedData.data)),k=h(N().props.value.search),i=h(!1),T=h(!1),q=h({sortBy:n.sortingData.column,descending:n.sortingData.descending==="true",page:n.paginatedData.current_page,rowsPerPage:n.paginatedData.per_page,rowsNumber:n.paginatedData.total}),L=[{name:"postTitle",required:!0,label:p("Title"),align:"left",sortable:!0,field:t=>t.title,style:"width: 35%"},{name:"postAuthor",required:!0,label:p("Author"),align:"left",field:t=>t.user.full_name,style:"width: 15%"},{name:"postPublishedAt",required:!0,label:p("To be published at"),align:"left",sortable:!0,field:t=>t.published_at,style:"width: 20%"},{name:"postStatus",required:!0,label:p("Status"),align:"left",sortable:!0,field:t=>t.status},{name:"postFavorite",required:!0,label:p("Favorite"),align:"left",sortable:!0,field:t=>t.favorite},{name:"postViews",required:!0,label:p("Views"),align:"center",sortable:!0,field:t=>t.views},{name:"postComments",required:!0,label:p("Comments"),align:"center",sortable:!0,field:t=>t.comments_count},{name:"postActions",required:!0,label:p("Actions"),align:"center",field:"actions"}],O=t=>{i.value=!0;const{page:u,rowsPerPage:S,sortBy:V,descending:f}=t.pagination,g=t.filter;w.Inertia.get("/admin/posts",{per_page:S,page:u,[V]:f?"asc":"desc",column:V,descending:f,search:g},{replace:!0}),q.value.page=u,q.value.rowsPerPage=S,q.value.sortBy=V,q.value.descending=f},Q=()=>{i.value=!0,T.value=!0,w.Inertia.get("/admin/posts")},G=t=>{let u=t.slug;w.Inertia.get(`/admin/posts/${u}/edit`)},J=t=>{let u=t.slug;i.value=!0,w.Inertia.delete(`/admin/posts/${u}`,{onSuccess:()=>M(),onError:()=>K()})},K=()=>{C.notify({type:"negative",message:p("Something went wrong with post deletion")})},M=()=>{C.notify({type:"positive",message:p("The post have been deleted successfully")})},W=()=>{w.Inertia.get("/admin/posts/create")},F=async t=>{await E(),w.Inertia.post("/admin/posts/status",{id:t,status:m[t],page:n.paginatedData.current_page,per_page:n.paginatedData.per_page,search:k.value},{onStart:()=>i.value=!0,onFinish:()=>i.value=!1,preserveScroll:!0})},X=async t=>{await E(),w.Inertia.post("/admin/posts/favorite",{id:t,favorite:D[t],page:n.paginatedData.current_page,per_page:n.paginatedData.per_page,search:k.value},{onStart:()=>i.value=!0,onFinish:()=>i.value=!1,preserveScroll:!0})};return(t,u)=>{const S=d("q-th"),V=d("q-tr"),f=d("q-icon"),g=d("q-tooltip"),P=d("q-btn"),$=d("q-td"),U=d("q-toggle"),A=d("q-badge"),Y=d("q-space"),Z=d("q-input"),ee=d("q-separator"),te=d("q-inner-loading"),ae=d("q-table");return r(),v("div",ce,[o(ae,{title:t.$t("Posts"),"row-key":e=>e.id,columns:L,rows:y(H),pagination:q.value,"onUpdate:pagination":u[1]||(u[1]=e=>q.value=e),filter:k.value,onRequest:O,loading:i.value,color:"primary",flat:"","binary-state-sort":"","rows-per-page-label":t.$t("Records per page"),"rows-per-page-options":[5,10,15,n.paginatedData.total,0],bordered:""},{header:a(e=>[o(V,{props:e},{default:a(()=>[(r(!0),v(x,null,se(e.cols,s=>(r(),b(S,{key:s.name,props:e,class:"text-primary"},{default:a(()=>[c(l(s.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":a(()=>[_("div",pe,[o(f,{size:"2em",name:"sentiment_dissatisfied",color:"red"}),_("span",me,l(t.$t("No data available")),1)])]),"body-cell-postActions":a(e=>[o($,{props:e,"auto-width":""},{default:a(()=>[_("div",ge,[o(P,{outline:"",color:"accent",icon:"edit",disable:i.value,onClick:s=>G(e.row),"data-test":"edit-button"},{default:a(()=>[o(g,{delay:1e3,anchor:"bottom middle",self:"center middle"},{default:a(()=>[c(l(t.$t("Edit post")),1)]),_:1})]),_:2},1032,["disable","onClick"]),e.row.status==="draft"||e.row.status==="pending"?(r(),b(P,{key:0,outline:"",color:"red",icon:"delete",disable:i.value,onClick:s=>J(e.row),"data-test":"delete-button"},{default:a(()=>[o(g,{delay:1e3,anchor:"bottom middle",self:"center middle"},{default:a(()=>[c(l(t.$t("Delete post")),1)]),_:1})]),_:2},1032,["disable","onClick"])):(r(),b(P,{key:1,outline:"",color:"grey",icon:"delete",disable:"","data-test":"delete-button"},{default:a(()=>[o(g,{delay:1e3,anchor:"bottom middle",self:"center middle"},{default:a(()=>[c(l(t.$t("Delete post")),1)]),_:1})]),_:1}))])]),_:2},1032,["props"])]),"body-cell-postViews":a(e=>[o($,{props:e,"auto-width":""},{default:a(()=>[_("span",_e,l(e.row.views),1)]),_:2},1032,["props"])]),"body-cell-postComments":a(e=>[o($,{props:e,"auto-width":""},{default:a(()=>[_("span",fe,l(e.row.comments_count),1)]),_:2},1032,["props"])]),"body-cell-postFavorite":a(e=>[o($,{props:e,"auto-width":""},{default:a(()=>[o(U,{color:"primary",icon:"star_rate","false-value":"usual","true-value":"favorite","onUpdate:modelValue":[s=>X(e.row.id),s=>D[`${e.row.id}`]=s],modelValue:D[`${e.row.id}`]},{default:a(()=>[o(g,{anchor:"bottom middle",self:"center middle",delay:500},{default:a(()=>[c(l(t.$t("Usual > Favorite")),1)]),_:1})]),_:2},1032,["onUpdate:modelValue","modelValue"])]),_:2},1032,["props"])]),"body-cell-postStatus":a(e=>[o($,{props:e,"auto-width":""},{default:a(()=>[e.row.status==="draft"?(r(),b(U,{key:0,color:"green","checked-icon":"hourglass_empty","unchecked-icon":"mode_edit","false-value":"draft","true-value":"pending","onUpdate:modelValue":[s=>F(e.row.id),s=>m[`${e.row.id}`]=s],modelValue:m[`${e.row.id}`]},{default:a(()=>[o(g,{anchor:"bottom middle",self:"center middle",delay:500},{default:a(()=>[c(l(t.$t("Draft > Pending")),1)]),_:1})]),_:2},1032,["onUpdate:modelValue","modelValue"])):e.row.status==="pending"?(r(),b(U,{key:1,color:"green","checked-icon":"upload","unchecked-icon":"hourglass_empty","false-value":"pending","true-value":"published","onUpdate:modelValue":[s=>F(e.row.id),s=>m[`${e.row.id}`]=s],modelValue:m[`${e.row.id}`]},{default:a(()=>[o(g,{anchor:"bottom middle",self:"center middle",delay:500},{default:a(()=>[c(l(t.$t("Pending > Published")),1)]),_:1})]),_:2},1032,["onUpdate:modelValue","modelValue"])):(r(),b(U,{key:2,color:"green","checked-icon":"upload","unchecked-icon":"block","true-value":"published","false-value":"unpublished","onUpdate:modelValue":[s=>F(e.row.id),s=>m[`${e.row.id}`]=s],modelValue:m[`${e.row.id}`]},{default:a(()=>[o(g,{anchor:"bottom middle",self:"center middle",delay:500},{default:a(()=>[c(l(t.$t("Unpublished > Published")),1)]),_:1})]),_:2},1032,["onUpdate:modelValue","modelValue"]))]),_:2},1032,["props"])]),"body-cell-postPublishedAt":a(e=>[o($,{props:e,"auto-width":""},{default:a(()=>[e.row.published_at?(r(),v("span",be,[c(l(e.row.published_at)+" ",1),e.row.status==="pending"?(r(),b(A,{key:0,align:"top",class:ne([y(R)(new Date(e.row.published_at),new Date)===-1?"text-green":"text-red"]),outline:""},{default:a(()=>[y(R)(new Date(e.row.published_at),new Date)===-1?(r(),v(x,{key:0},[c(" + "+l(y(j)(new Date(e.row.published_at))),1)],64)):(r(),v(x,{key:1},[c(" - "+l(y(j)(new Date(e.row.published_at))),1)],64))]),_:2},1032,["class"])):re("",!0)])):(r(),v("span",we,[o(A,{outline:"",class:"text-grey"},{default:a(()=>[c(l(t.$t("no date set")),1)]),_:1})]))]),_:2},1032,["props"])]),top:a(()=>[_("div",he,l(t.$t("Posts")),1),o(Y),o(Z,{clearable:"","clear-icon":"close",dense:"",debounce:"300","label-color":"primary",modelValue:k.value,"onUpdate:modelValue":u[0]||(u[0]=e=>k.value=e),"label-slot":"","data-test":"search-input"},{append:a(()=>[o(f,{name:"search",color:"primary"})]),label:a(()=>[_("div",null,l(t.$t("Search")),1)]),_:1},8,["modelValue"]),o(P,{class:"q-ml-md",color:"primary",outline:"",disable:i.value,onClick:Q,"data-test":"refresh-button",loading:T.value,icon:"restart_alt"},null,8,["disable","loading"]),o(ee,{vertical:"",spaced:"",inset:""}),o(P,{color:"green",unelevated:"",onClick:W,"data-test":"add-button",disable:!y(N)().props.value.can.create_post},{default:a(()=>[o(f,{left:"",name:"post_add"}),_("div",null,l(t.$t("ADD POST")),1)]),_:1},8,["disable"])]),loading:a(()=>[o(te,{showing:"",color:"primary"})]),_:1},8,["title","row-key","rows","pagination","filter","loading","rows-per-page-label","rows-per-page-options"])])}}}),ke=z({__name:"Index",props:{model:null},setup(B){const n=B,C=h(ue);return(m,D)=>(r(),v(x,null,[o(y(de),{title:"Blog posts"}),o(ie,{data:C.value},null,8,["data"]),o(ve,{paginatedData:n.model.posts,sortingData:n.model.sorting},null,8,["paginatedData","sortingData"])],64))}});export{ke as default};
