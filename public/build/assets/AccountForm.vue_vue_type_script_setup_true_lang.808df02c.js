import{d as me,u as pe,r as V,y as _e,a as S,v as U,b as c,o as g,e as y,g as e,h as a,j as h,t as n,f as s,i as t,l as F,k as ve,x as fe,L as ge,p as he,n as f}from"./app.2d2cf3e6.js";import{U as z}from"./PaginatedData.7e19470a.js";const be={class:"q-mt-md"},we={class:"column q-col-gutter-md"},ye={class:"row q-col-gutter-x-md"},qe={class:"col-8 q-col-gutter-y-md"},xe={class:"row q-col-gutter-md"},Ve={class:"col-6"},$e={class:"col q-mb-md"},Ue={class:"text-subtitle2 text-primary text-weight-regular"},ke={class:"col"},Pe={class:"text-subtitle2 text-primary text-weight-regular"},Ae={class:"col-6"},Ce={class:"col q-mb-md"},Se={class:"text-subtitle2 text-primary text-weight-regular"},Fe={class:"col"},ze={class:"text-subtitle2 text-primary text-weight-regular"},Ee={class:"row q-col-gutter-md"},je={class:"col"},Te={class:"col q-mb-md"},Be={class:"text-subtitle2 text-primary text-weight-regular"},Ne={class:"col"},Re={class:"text-subtitle2 text-primary text-weight-regular"},De={class:"col-4 column q-col-gutter-y-md"},Le={class:"col-auto"},Ie={class:"text-subtitle2 text-primary text-weight-regular"},Me={class:"row flex-center relative-position"},Oe={key:0},Qe={key:1},Ge={key:2,class:"absolute-top-right"},He={key:4,class:"light-dimmed transparent absolute-full bg-grey-3"},Je={class:"row q-mt-md justify-between items-center"},Ke={class:"text-subtitle2 text-primary text-weight-regular"},We={class:"text-right"},Xe={class:"row justify-between items-center"},Ye={class:"text-subtitle2 text-primary text-weight-regular"},Ze={class:"text-right"},et={class:"row justify-between items-center"},tt={class:"text-subtitle2 text-primary text-weight-regular"},st={key:0,class:"row items-center"},at={class:"text-green"},ot={key:1,class:"row items-center"},rt={class:"text-red"},lt={class:"row justify-between items-center"},it={class:"text-subtitle2 text-primary text-weight-regular"},nt={class:"text-right"},dt={class:"row justify-between items-center"},ut={class:"text-subtitle2 text-primary text-weight-regular"},ct={class:"text-subtitle2 text-primary text-weight-regular"},mt={class:"row flex-center text-h2 text-grey"},pt={class:"col-auto"},_t={class:"column"},vt={class:"col-auto"},ft={class:"column"},gt={class:"row justify-end items-center"},ht={class:"row q-col-gutter-md"},yt=me({__name:"AccountForm",props:{data:null},setup(M){const u=M,_=pe(),k=V(!1),E=V(!1),P=V(!1),A=V(!1),C=_e().props.value.auth.user.role,j=V(C===z.SuperAdmin||C===z.Admin?"admin":C===z.Author?"author":"member"),l=S({id:u.data.user.id,email:u.data.user.email,first_name:u.data.user.first_name,last_name:u.data.user.last_name,intro:u.data.user.intro,last_login:u.data.user.last_login,mobile:u.data.user.mobile,posts_count:u.data.user.posts_count,profile:u.data.user.profile,registered_at:u.data.user.registered_at,roles:u.data.user.roles,status:u.data.user.status,email_verified_at:u.data.user.email_verified_at,avatar:u.data.user.avatar}),O=U(()=>u.data.user.avatar),T=U(()=>!!u.data.user.avatar),d=S({current_password:null,password:null,password_confirmation:null}),$=S({_method:"put",avatar:null,id:u.data.user.id}),Q=()=>l.put("/user/profile-information",{onSuccess:()=>se(),onError:()=>ae()}),p=V(!0),G=U(()=>l.first_name[0]+l.last_name[0]),H=()=>d.put("/user/password",{onSuccess:()=>W(),onError:()=>X()}),J=()=>$.post(`/${j.value}/avatar`,{onSuccess:()=>Y(),onError:()=>Z()}),K=()=>he.Inertia.post(`/${j.value}/avatar`,{id:u.data.user.id},{onStart:()=>{k.value=!0,E.value=!0},onSuccess:()=>ee(),onError:()=>te(),onFinish:()=>{k.value=!1,E.value=!1},preserveScroll:!0}),W=()=>{d.current_password=null,d.password=null,d.password_confirmation=null,P.value=!1,_.notify({type:"positive",message:f("The password has been updated successfully")})},X=()=>{_.notify({type:"negative",message:f("There were errors while updating password")})},Y=()=>{$.avatar=null,A.value=!1,_.notify({type:"positive",message:f("The avatar has been updated successfully")})},Z=()=>{_.notify({type:"negative",message:f("There were errors while updating avatar")})},ee=()=>{_.notify({type:"positive",message:f("The avatar has been removed successfully")})},te=()=>{_.notify({type:"negative",message:f("There were errors while removing avatar")})},se=()=>{_.notify({type:"positive",message:f("The profile has been updated successfully")})},ae=()=>{_.notify({type:"negative",message:f("There were errors while updating profile")})},oe=r=>{_.notify({type:"negative",message:r.length+f(" file(s) did not pass validation constraints")})},B=U(()=>!!d.errors.updatePassword&&!!d.errors.updatePassword.current_password),N=U(()=>!!d.errors.updatePassword&&!!d.errors.updatePassword.password),re=()=>{window.history.back()};return(r,i)=>{const v=c("q-card-section"),m=c("q-icon"),b=c("q-input"),w=c("q-card"),R=c("q-editor"),q=c("q-separator"),D=c("q-avatar"),le=c("q-img"),ie=c("q-tooltip"),x=c("q-btn"),ne=c("q-spinner-gears"),L=c("q-expansion-item"),I=c("q-list"),de=c("q-file"),ue=c("q-spinner-hourglass"),ce=c("q-form");return g(),y("div",be,[e(ce,{onSubmit:Q},{default:a(()=>[e(w,{flat:"",bordered:""},{default:a(()=>[e(v,{class:"text-primary text-h6"},{default:a(()=>[h(n(r.$t("Account information")),1)]),_:1}),e(v,null,{default:a(()=>[s("div",we,[s("div",ye,[s("div",qe,[s("div",xe,[s("div",Ve,[e(w,{flat:"",bordered:""},{default:a(()=>[e(v,null,{default:a(()=>[s("div",$e,[s("div",Ue,n(r.$t("First name")),1),e(b,{modelValue:t(l).first_name,"onUpdate:modelValue":i[0]||(i[0]=o=>t(l).first_name=o),dense:"","data-test":"first_name-input",rules:[o=>!!o||r.$t("Field is required"),o=>o.length<=40||r.$t("Please use maximum characters: ")+"40"],ref:"fNameRef","error-message":t(l).errors.first_name,error:!!t(l).errors.first_name,"bottom-slots":"",clearable:"","clear-icon":"close"},{prepend:a(()=>[e(m,{name:"edit",color:"orange"})]),_:1},8,["modelValue","rules","error-message","error"])]),s("div",ke,[s("div",Pe,n(r.$t("Last name")),1),e(b,{modelValue:t(l).last_name,"onUpdate:modelValue":i[1]||(i[1]=o=>t(l).last_name=o),dense:"","data-test":"last_name-input",rules:[o=>!!o||r.$t("Field is required"),o=>o.length<=40||r.$t("Please use maximum characters: ")+"40"],ref:"lNameRef","error-message":t(l).errors.last_name,error:!!t(l).errors.last_name,"bottom-slots":"",clearable:"","clear-icon":"close"},{prepend:a(()=>[e(m,{name:"edit",color:"orange"})]),_:1},8,["modelValue","rules","error-message","error"])])]),_:1})]),_:1})]),s("div",Ae,[e(w,{flat:"",bordered:""},{default:a(()=>[e(v,null,{default:a(()=>[s("div",Ce,[s("div",Se,n(r.$t("Mobile")),1),e(b,{modelValue:t(l).mobile,"onUpdate:modelValue":i[2]||(i[2]=o=>t(l).mobile=o),type:"tel",dense:"","data-test":"mobile-input",rules:[o=>!!o||r.$t("Field is required"),o=>o.length<=20||r.$t("Please use maximum characters: ")+"20"],ref:"mobileRef","error-message":t(l).errors.mobile,error:!!t(l).errors.mobile,"bottom-slots":"",clearable:"","clear-icon":"close"},{prepend:a(()=>[e(m,{name:"phone_iphone",color:"orange"})]),_:1},8,["modelValue","rules","error-message","error"])]),s("div",Fe,[s("div",ze,n(r.$t("Email")),1),e(b,{modelValue:t(l).email,"onUpdate:modelValue":i[3]||(i[3]=o=>t(l).email=o),type:"email",dense:"","data-test":"email-input",rules:[o=>!!o||r.$t("Field is required"),o=>o.length<=40||r.$t("Please use maximum characters: ")+"40"],ref:"emailRef","error-message":t(l).errors.email,error:!!t(l).errors.email,"bottom-slots":"",clearable:"","clear-icon":"close"},{prepend:a(()=>[e(m,{name:"email",color:"orange"})]),_:1},8,["modelValue","rules","error-message","error"])])]),_:1})]),_:1})])]),s("div",Ee,[s("div",je,[e(w,{flat:"",bordered:""},{default:a(()=>[e(v,null,{default:a(()=>[s("div",Te,[s("div",Be,n(r.$t("Short introduction info")),1),e(R,{placeholder:r.$t("Drop some lines..."),modelValue:t(l).intro,"onUpdate:modelValue":i[4]||(i[4]=o=>t(l).intro=o),"min-height":"5rem"},null,8,["placeholder","modelValue"])]),s("div",Ne,[s("div",Re,n(r.$t("Profile description")),1),e(R,{"min-height":"8rem",placeholder:r.$t("Drop some lines..."),modelValue:t(l).profile,"onUpdate:modelValue":i[5]||(i[5]=o=>t(l).profile=o)},null,8,["placeholder","modelValue"])])]),_:1})]),_:1})])])]),s("div",De,[s("div",Le,[e(w,{flat:"",bordered:""},{default:a(()=>[e(v,{class:"column"},{default:a(()=>[s("div",Ie,n(r.$t("Current avatar")),1),e(q,{spaced:""}),s("div",Me,[t(T)?(g(),y("div",Qe,[e(D,{size:"100px"},{default:a(()=>[e(le,{height:"100px",src:t(O)},null,8,["src"])]),_:1})])):(g(),y("div",Oe,[e(D,{size:"100px",color:"orange"},{default:a(()=>[h(n(t(G)),1)]),_:1})])),t(T)?(g(),y("div",Ge,[e(x,{round:"",icon:"delete",color:"accent",onClick:K},{default:a(()=>[e(ie,{delay:1e3,anchor:"bottom middle",self:"center middle"},{default:a(()=>[h(n(r.$t("Remove avatar")),1)]),_:1})]),_:1})])):F("",!0),k.value?(g(),ve(ne,{key:3,size:"4em",class:"absolute-center z-max",color:"accent"})):F("",!0),k.value?(g(),y("div",He)):F("",!0)]),s("div",Je,[s("div",Ke,n(r.$t("User registered at:")),1),s("div",We,n(t(l).registered_at),1)]),e(q,{spaced:""}),s("div",Xe,[s("div",Ye,n(r.$t("User last logged-in:")),1),s("div",Ze,n(t(l).last_login),1)]),e(q,{spaced:""}),s("div",et,[s("div",tt,n(r.$t("Email status:")),1),t(l).email_verified_at?(g(),y("div",st,[e(m,{size:"1.5rem",name:"verified",color:"green",class:"q-mr-xs"}),s("div",at,n(r.$t("Verified")),1)])):(g(),y("div",ot,[e(x,{size:"sm",color:"red",label:"Verify Email",class:"q-mr-sm"}),e(m,{size:"1.5rem",name:"error_outline",color:"red",class:"q-mr-xs"}),s("div",rt,n(r.$t("Not Verified")),1)]))]),e(q,{spaced:""}),s("div",lt,[s("div",it,n(r.$t("User role:")),1),s("div",nt,n(t(l).roles),1)]),e(q,{spaced:""}),s("div",dt,[s("div",ut,n(r.$t("User status:")),1),s("div",{class:fe(["text-right",[t(l).status==="enabled"?"text-green":"text-red"]])},n(t(l).status),3)]),e(q,{spaced:""}),s("div",ct,n(r.$t("User posts")),1),s("div",mt,n(t(l).posts_count),1)]),_:1})]),_:1})]),s("div",pt,[e(I,{bordered:"",class:"rounded-borders"},{default:a(()=>[e(L,{modelValue:P.value,"onUpdate:modelValue":i[12]||(i[12]=o=>P.value=o),"expand-separator":"",icon:"lock_reset",label:r.$t("Password update"),"header-class":"text-primary","data-test":"expanded-list"},{default:a(()=>[e(w,null,{default:a(()=>[e(v,null,{default:a(()=>[s("div",_t,[s("div",null,[e(b,{modelValue:t(d).current_password,"onUpdate:modelValue":i[7]||(i[7]=o=>t(d).current_password=o),dense:"",clearable:"","clear-icon":"close",label:r.$t("Current password"),type:p.value?"password":"text","bottom-slots":"","error-message":t(B)?t(d).errors.updatePassword.current_password:null,error:t(B),disable:t(d).processing},{prepend:a(()=>[e(m,{name:"lock",color:"orange"})]),append:a(()=>[e(m,{name:p.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:i[6]||(i[6]=o=>p.value=!p.value)},null,8,["name"])]),_:1},8,["modelValue","label","type","error-message","error","disable"])]),s("div",null,[e(b,{modelValue:t(d).password,"onUpdate:modelValue":i[9]||(i[9]=o=>t(d).password=o),dense:"",clearable:"","clear-icon":"close",label:r.$t("New password"),type:p.value?"password":"text","bottom-slots":"","error-message":t(N)?t(d).errors.updatePassword.password:null,error:t(N),disable:t(d).processing},{prepend:a(()=>[e(m,{name:"key",color:"orange"})]),append:a(()=>[e(m,{name:p.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:i[8]||(i[8]=o=>p.value=!p.value)},null,8,["name"])]),_:1},8,["modelValue","label","type","error-message","error","disable"])]),s("div",null,[e(b,{modelValue:t(d).password_confirmation,"onUpdate:modelValue":i[11]||(i[11]=o=>t(d).password_confirmation=o),dense:"",clearable:"","clear-icon":"close",label:r.$t("Confirm new password"),type:p.value?"password":"text","error-message":t(d).errors.password_confirmation,error:!!t(d).errors.password_confirmation,disable:t(d).processing},{prepend:a(()=>[e(m,{name:"key",color:"orange"})]),append:a(()=>[e(m,{name:p.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:i[10]||(i[10]=o=>p.value=!p.value)},null,8,["name"])]),_:1},8,["modelValue","label","type","error-message","error","disable"])]),e(x,{onClick:H,flat:"",color:"primary",loading:t(d).processing},{default:a(()=>[h(n(r.$t("Update")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue","label"])]),_:1})]),s("div",vt,[e(I,{bordered:"",class:"rounded-borders"},{default:a(()=>[e(L,{modelValue:A.value,"onUpdate:modelValue":i[14]||(i[14]=o=>A.value=o),"expand-separator":"",icon:"perm_identity",label:r.$t("Avatar update"),"header-class":"text-primary","data-test":"expanded-list"},{default:a(()=>[e(w,null,{default:a(()=>[e(v,null,{default:a(()=>[s("div",ft,[e(de,{dense:"","max-file-size":"1024000",modelValue:t($).avatar,"onUpdate:modelValue":i[13]||(i[13]=o=>t($).avatar=o),counter:"","max-files":"1",accept:".jpg, .png, image/*",onRejected:oe},{prepend:a(()=>[e(m,{color:"orange",name:"image"})]),hint:a(()=>[h(n(r.$t("Only image format file, max. size < 1 MB")),1)]),_:1},8,["modelValue"]),e(x,{class:"q-mt-md",onClick:J,flat:"",color:"primary",loading:t($).processing},{default:a(()=>[h(n(r.$t("Update")),1)]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1},8,["modelValue","label"])]),_:1})])])])])]),_:1}),e(v,null,{default:a(()=>[s("div",gt,[s("div",ht,[s("div",null,[e(t(ge),{as:"div",onClick:re},{default:a(()=>[e(x,{outline:"",color:"secondary",disable:t(l).processing},{default:a(()=>[h(n(r.$t("Back")),1)]),_:1},8,["disable"])]),_:1})]),s("div",null,[e(x,{type:"submit",outline:"",color:"primary",loading:t(l).processing},{loading:a(()=>[e(ue)]),default:a(()=>[h(n(r.$t("Update"))+" ",1)]),_:1},8,["loading"])])])])]),_:1})]),_:1})]),_:1})])}}});export{yt as _};
