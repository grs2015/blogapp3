import{d as N,u as ee,v as te,r as k,y as I,C as ae,n as _,b as i,o as l,e as w,g as o,h as a,F as S,q as oe,f as g,t as s,k as c,j as d,i as y,x as se,l as le,p as h,E as ne,H as re}from"./app.2d2cf3e6.js";import{f as ie,_ as de}from"./breadcrumbsData.2260b39f.js";import{c as z}from"./index.673391cf.js";import{f as F}from"./index.18f6e9ea.js";import{_ as ue}from"./LayoutAuthor.vue_vue_type_style_index_0_lang.81cc6e5e.js";const ce={class:"q-mt-md"},pe={class:"full-width row flex-center text-primary q-gutter-sm"},me={class:"text-red"},_e={class:"row flex-center q-gutter-x-sm no-wrap"},ge={class:"text-primary text-subtitle1"},fe={class:"text-primary text-subtitle1"},be={class:"text-primary text-subtitle1"},he={key:0},we={key:1,class:"text-grey"},ye={class:"q-table__title text-primary"},ve=N({__name:"PostAuthorTable",props:{paginatedData:null,sortingData:null},setup(V){const r=V,P=ee(),B=te(()=>(p.value=!1,r.paginatedData.data.forEach((t,n)=>{C[`${t.id}`]=k(`${t.status}`)}),r.paginatedData.data)),D=k(I().props.value.search),p=k(!1),T=k(!1),C=ae({}),v=k({sortBy:r.sortingData.column,descending:r.sortingData.descending==="true",page:r.paginatedData.current_page,rowsPerPage:r.paginatedData.per_page,rowsNumber:r.paginatedData.total}),R=[{name:"postTitle",required:!0,label:_("Title"),align:"left",sortable:!0,field:t=>t.title,style:"width: 35%"},{name:"postPublishedAt",required:!0,label:_("To be published at"),align:"left",sortable:!0,field:t=>t.published_at,style:"width: 20%"},{name:"postStatus",required:!0,label:_("Status"),align:"center",sortable:!0,field:t=>t.status},{name:"postFavorite",required:!0,label:_("Favorite"),align:"center",sortable:!0,field:t=>t.favorite},{name:"postRating",required:!0,label:_("Rating"),align:"center",sortable:!0,field:t=>t.rating},{name:"postViews",required:!0,label:_("Views"),align:"center",sortable:!0,field:t=>t.views},{name:"postComments",required:!0,label:_("Comments"),align:"center",sortable:!0,field:t=>t.comments_count},{name:"postActions",required:!0,label:_("Actions"),align:"center",field:"actions"}],E=t=>{p.value=!0;const{page:n,rowsPerPage:x,sortBy:$,descending:u}=t.pagination,m=t.filter;h.Inertia.get("/author/posts",{per_page:x,page:n,[$]:u?"asc":"desc",column:$,descending:u,search:m}),v.value.page=n,v.value.rowsPerPage=x,v.value.sortBy=$,v.value.descending=u},U=()=>{p.value=!0,T.value=!0,h.Inertia.get("/author/posts")},H=t=>{let n=t.slug;h.Inertia.get(`/author/posts/${n}/edit`)},j=t=>{let n=t.slug;h.Inertia.get(`/author/posts/${n}`)},L=t=>{let n=t.slug;p.value=!0,h.Inertia.delete(`/author/posts/${n}`,{onSuccess:()=>O(),onError:()=>M()})},M=()=>{P.notify({type:"negative",message:_("Something went wrong with post deletion")})},O=()=>{P.notify({type:"positive",message:_("The post have been deleted successfully")})},Q=()=>{h.Inertia.get("/author/posts/create")},G=async t=>{await ne(),h.Inertia.post("/author/posts/status",{id:t,status:C[t],page:r.paginatedData.current_page,per_page:r.paginatedData.per_page,search:D.value},{onStart:()=>p.value=!0,onFinish:()=>p.value=!1,preserveScroll:!0})};return(t,n)=>{const x=i("q-th"),$=i("q-tr"),u=i("q-icon"),m=i("q-tooltip"),q=i("q-btn"),b=i("q-td"),J=i("q-toggle"),A=i("q-badge"),K=i("q-space"),W=i("q-input"),X=i("q-separator"),Y=i("q-inner-loading"),Z=i("q-table");return l(),w("div",ce,[o(Z,{title:t.$t("Posts"),"row-key":e=>e.id,columns:R,rows:y(B),pagination:v.value,"onUpdate:pagination":n[1]||(n[1]=e=>v.value=e),filter:D.value,onRequest:E,loading:p.value,color:"primary",flat:"","binary-state-sort":"","rows-per-page-label":t.$t("Records per page"),"rows-per-page-options":[5,10,15,r.paginatedData.total,0],bordered:""},{header:a(e=>[o($,{props:e},{default:a(()=>[(l(!0),w(S,null,oe(e.cols,f=>(l(),c(x,{key:f.name,props:e,class:"text-primary"},{default:a(()=>[d(s(f.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"no-data":a(()=>[g("div",pe,[o(u,{size:"2em",name:"sentiment_dissatisfied",color:"red"}),g("span",me,s(t.$t("No data available")),1)])]),"body-cell-postActions":a(e=>[o(b,{props:e,"auto-width":""},{default:a(()=>[g("div",_e,[e.row.status==="draft"||e.row.status==="pending"?(l(),c(q,{key:0,outline:"",color:"accent",icon:"edit",disable:p.value,onClick:f=>H(e.row),"data-test":"edit-button"},{default:a(()=>[o(m,{delay:1e3,anchor:"bottom middle",self:"center middle"},{default:a(()=>[d(s(t.$t("Edit post")),1)]),_:1})]),_:2},1032,["disable","onClick"])):(l(),c(q,{key:1,outline:"",color:"secondary",icon:"visibility",disable:p.value,onClick:f=>j(e.row),"data-test":"view-button"},{default:a(()=>[o(m,{delay:1e3,anchor:"bottom middle",self:"center middle"},{default:a(()=>[d(s(t.$t("View post")),1)]),_:1})]),_:2},1032,["disable","onClick"])),e.row.status==="draft"||e.row.status==="pending"?(l(),c(q,{key:2,outline:"",color:"red",icon:"delete",disable:p.value,onClick:f=>L(e.row),"data-test":"delete-button"},{default:a(()=>[o(m,{delay:1e3,anchor:"bottom middle",self:"center middle"},{default:a(()=>[d(s(t.$t("Delete post")),1)]),_:1})]),_:2},1032,["disable","onClick"])):(l(),c(q,{key:3,outline:"",color:"grey",icon:"delete",disable:"","data-test":"delete-button"},{default:a(()=>[o(m,{delay:1e3,anchor:"bottom middle",self:"center middle"},{default:a(()=>[d(s(t.$t("Delete post")),1)]),_:1})]),_:1}))])]),_:2},1032,["props"])]),"body-cell-postRating":a(e=>[o(b,{props:e,"auto-width":""},{default:a(()=>[g("span",ge,s(e.row.rating),1)]),_:2},1032,["props"])]),"body-cell-postViews":a(e=>[o(b,{props:e,"auto-width":""},{default:a(()=>[g("span",fe,s(e.row.views),1)]),_:2},1032,["props"])]),"body-cell-postComments":a(e=>[o(b,{props:e,"auto-width":""},{default:a(()=>[g("span",be,s(e.row.comments_count),1)]),_:2},1032,["props"])]),"body-cell-postFavorite":a(e=>[o(b,{props:e,"auto-width":""},{default:a(()=>[e.row.favorite==="usual"?(l(),c(u,{key:0,color:"grey-4",name:"star_border",size:"24px"})):(l(),c(u,{key:1,color:"green",name:"star",size:"24px"}))]),_:2},1032,["props"])]),"body-cell-postStatus":a(e=>[o(b,{props:e,"auto-width":""},{default:a(()=>[e.row.status==="draft"?(l(),c(J,{key:0,color:"green","checked-icon":"hourglass_empty","unchecked-icon":"mode_edit","false-value":"draft","true-value":"pending","onUpdate:modelValue":[f=>G(e.row.id),f=>C[`${e.row.id}`]=f],modelValue:C[`${e.row.id}`]},{default:a(()=>[o(m,{anchor:"bottom middle",self:"center middle",delay:500},{default:a(()=>[d(s(t.$t("Draft > Pending")),1)]),_:1})]),_:2},1032,["onUpdate:modelValue","modelValue"])):e.row.status==="pending"?(l(),c(u,{key:1,color:"grey",name:"schedule",size:"24px"},{default:a(()=>[o(m,{anchor:"bottom middle",self:"center middle",delay:500},{default:a(()=>[d(s(t.$t("Pending")),1)]),_:1})]),_:1})):e.row.status==="published"?(l(),c(u,{key:2,color:"green",name:"visibility",size:"24px"},{default:a(()=>[o(m,{anchor:"bottom middle",self:"center middle",delay:500},{default:a(()=>[d(s(t.$t("Published")),1)]),_:1})]),_:1})):(l(),c(u,{key:3,color:"grey",name:"visibility_off",size:"24px"},{default:a(()=>[o(m,{anchor:"bottom middle",self:"center middle",delay:500},{default:a(()=>[d(s(t.$t("Unpublished")),1)]),_:1})]),_:1}))]),_:2},1032,["props"])]),"body-cell-postPublishedAt":a(e=>[o(b,{props:e,"auto-width":""},{default:a(()=>[e.row.published_at?(l(),w("span",he,[d(s(e.row.published_at)+" ",1),e.row.status==="pending"?(l(),c(A,{key:0,align:"top",class:se([y(z)(new Date(e.row.published_at),new Date)===-1?"text-green":"text-red"]),outline:""},{default:a(()=>[y(z)(new Date(e.row.published_at),new Date)===-1?(l(),w(S,{key:0},[d(" + "+s(y(F)(new Date(e.row.published_at))),1)],64)):(l(),w(S,{key:1},[d(" - "+s(y(F)(new Date(e.row.published_at))),1)],64))]),_:2},1032,["class"])):le("",!0)])):(l(),w("span",we,[o(A,{outline:"",class:"text-grey"},{default:a(()=>[d(s(t.$t("no date set")),1)]),_:1})]))]),_:2},1032,["props"])]),top:a(()=>[g("div",ye,s(t.$t("My Posts")),1),o(K),o(W,{clearable:"","clear-icon":"close",dense:"",debounce:"300","label-color":"primary",modelValue:D.value,"onUpdate:modelValue":n[0]||(n[0]=e=>D.value=e),"label-slot":"","data-test":"search-input"},{append:a(()=>[o(u,{name:"search",color:"primary"})]),label:a(()=>[g("div",null,s(t.$t("Search")),1)]),_:1},8,["modelValue"]),o(q,{class:"q-ml-md",color:"primary",outline:"",disable:p.value,onClick:U,"data-test":"refresh-button",loading:T.value,icon:"restart_alt"},null,8,["disable","loading"]),o(X,{vertical:"",spaced:"",inset:""}),o(q,{color:"green",unelevated:"",onClick:Q,"data-test":"add-button",disable:!y(I)().props.value.can.create_post},{default:a(()=>[o(u,{left:"",name:"post_add"}),g("div",null,s(t.$t("ADD POST")),1)]),_:1},8,["disable"])]),loading:a(()=>[o(Y,{showing:"",color:"primary"})]),_:1},8,["title","row-key","rows","pagination","filter","loading","rows-per-page-label","rows-per-page-options"])])}}}),qe={layout:ue},xe=N({...qe,__name:"Index",props:{model:null},setup(V){const r=V,P=k(ie);return(B,D)=>(l(),w(S,null,[o(y(re),{title:"Blog posts"}),o(de,{data:P.value},null,8,["data"]),o(ve,{paginatedData:r.model.posts,sortingData:r.model.sorting},null,8,["paginatedData","sortingData"])],64))}});export{xe as default};
